<!DOCTYPE html><html><head><meta charset="utf-8"><style>@font-face {
  font-family: octicons-anchor;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

* {
    box-sizing: border-box;
}

body {
    width: 980px;
    margin-right: auto;
    margin-left: auto;
}

body .markdown-body {
    padding: 45px;
    border: 1px solid #ddd;
    border-radius: 3px;
    word-wrap: break-word;
}

pre {
    font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  color: #333;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body strong {
  font-weight: bold;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body input {
  font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}

.markdown-body a {
  color: #4078c0;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before {
  display: table;
  content: "";
}

.markdown-body hr:after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
  font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body .select::-ms-expand {
  opacity: 0;
}

.markdown-body .octicon {
  font: normal normal normal 16px/1 octicons-anchor;
  display: inline-block;
  text-decoration: none;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.markdown-body .octicon-link:before {
  content: '\f05c';
}

.markdown-body:before {
  display: table;
  content: "";
}

.markdown-body:after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body .anchor {
  display: inline-block;
  padding-right: 2px;
  margin-left: -18px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #000;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h1 .anchor {
  line-height: 1;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 .anchor {
  line-height: 1;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h3 .anchor {
  line-height: 1.2;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h4 .anchor {
  line-height: 1.2;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h5 .anchor {
  line-height: 1.1;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body h6 .anchor {
  line-height: 1.1;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  box-sizing: content-box;
  background-color: #fff;
}

.markdown-body code {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}

.markdown-body .pl-c {
  color: #969896;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #0086b3;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #795da3;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #333;
}

.markdown-body .pl-ent {
  color: #63a35c;
}

.markdown-body .pl-k {
  color: #a71d5d;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #183691;
}

.markdown-body .pl-v {
  color: #ed6a43;
}

.markdown-body .pl-id {
  color: #b52a1d;
}

.markdown-body .pl-ii {
  background-color: #b52a1d;
  color: #f8f8f8;
}

.markdown-body .pl-sr .pl-cce {
  color: #63a35c;
  font-weight: bold;
}

.markdown-body .pl-ml {
  color: #693a17;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #1d3e81;
  font-weight: bold;
}

.markdown-body .pl-mq {
  color: #008080;
}

.markdown-body .pl-mi {
  color: #333;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #333;
  font-weight: bold;
}

.markdown-body .pl-md {
  background-color: #ffecec;
  color: #bd2c00;
}

.markdown-body .pl-mi1 {
  background-color: #eaffea;
  color: #55a532;
}

.markdown-body .pl-mdr {
  color: #795da3;
  font-weight: bold;
}

.markdown-body .pl-mo {
  color: #1d3e81;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}

.markdown-body .plan-price-unit {
  color: #767676;
  font-weight: normal;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 0.35em 0.25em -1.6em;
  vertical-align: middle;
}

.markdown-body .plan-choice {
  padding: 15px;
  padding-left: 40px;
  display: block;
  border: 1px solid #e0e0e0;
  position: relative;
  font-weight: normal;
  background-color: #fafafa;
}

.markdown-body .plan-choice.open {
  background-color: #fff;
}

.markdown-body .plan-choice.open .plan-choice-seat-breakdown {
  display: block;
}

.markdown-body .plan-choice-free {
  border-radius: 3px 3px 0 0;
}

.markdown-body .plan-choice-paid {
  border-radius: 0 0 3px 3px;
  border-top: 0;
  margin-bottom: 20px;
}

.markdown-body .plan-choice-radio {
  position: absolute;
  left: 15px;
  top: 18px;
}

.markdown-body .plan-choice-exp {
  color: #999;
  font-size: 12px;
  margin-top: 5px;
}

.markdown-body .plan-choice-seat-breakdown {
  margin-top: 10px;
  display: none;
}

.markdown-body :checked+.radio-label {
  z-index: 1;
  position: relative;
  border-color: #4078c0;
}
</style><title>README</title></head><body><article class="markdown-body"><h1>
<a id="user-content-sailsjs-in-action" class="anchor" href="#sailsjs-in-action" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Sails.js in Action</h1>
<p>Trying out Sails through <strong><a href="https://www.manning.com/books/sails-js-in-action">Sails.js in Action</a></strong> by <strong>Mike McNeil</strong> and <strong>Irl Nathan</strong></p>
<blockquote>
<p>Sails.js in Action is a comprehensive guide to building enterprise-capable web applications using Node and Sails. Written by the creators of the Sails.js framework, this book carefully introduces each concept, technique, and tool with real-world examples and crystal clear explanations.</p>
</blockquote>
<h2>
<a id="user-content-run" class="anchor" href="#run" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Run</h2>
<p>Clone, install dependencies and run sailsjs:</p>
<div class="highlight highlight-source-shell"><pre>git clone https://github.com/eddyyanto/brushfire.git
npm install
sailsjs lift</pre></div>
<h2>
<a id="user-content-chapter-1-2-3--getting-started" class="anchor" href="#chapter-1-2-3--getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 1, 2, 3 — Getting Started</h2>
<p>General web development, introduction to Sailsjs and static assets generator.</p>
<h2>
<a id="user-content-chapter-4--using-the-blueprint-api" class="anchor" href="#chapter-4--using-the-blueprint-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 4 — Using the blueprint API</h2>
<p><strong>Shortcut blueprint routes and actions for video API</strong>:</p>
<table>
<thead>
<tr>
<th>Verb</th>
<th>Path/routes</th>
<th>Action</th>
<th>Eg</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/video/find</td>
<td>find</td>
<td><a href="http://localhost:1337/video">http://localhost:1337/video</a></td>
</tr>
<tr>
<td>GET</td>
<td>/video/find/:id</td>
<td>find</td>
<td><a href="http://localhost:1337/video/1">http://localhost:1337/video/1</a></td>
</tr>
<tr>
<td>GET</td>
<td>/video/create</td>
<td>create</td>
<td><a href="http://localhost:1337/video/create?title=title&amp;src=src">http://localhost:1337/video/create?title=title&amp;src=src</a></td>
</tr>
<tr>
<td>GET</td>
<td>/video/update/:id</td>
<td>update</td>
<td>
<a href="http://localhost:1337/video/update/3?title=new">http://localhost:1337/video/update/3?title=new</a> title</td>
</tr>
<tr>
<td>GET</td>
<td>/video/destroy/:id</td>
<td>destroy</td>
<td><a href="http://localhost:1337/video/destroy/4">http://localhost:1337/video/destroy/4</a></td>
</tr>
</tbody>
</table>
<p><strong>RESTful blueprint routes and actions for video API</strong></p>
<table>
<thead>
<tr>
<th>Verb</th>
<th>Path/Route</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/video/</td>
<td>find</td>
</tr>
<tr>
<td>GET</td>
<td>/video/:id</td>
<td>find</td>
</tr>
<tr>
<td>POST</td>
<td>/video</td>
<td>create</td>
</tr>
<tr>
<td>PUT</td>
<td>/video/:id</td>
<td>update</td>
</tr>
<tr>
<td>DELETE</td>
<td>/video/:id</td>
<td>destroy</td>
</tr>
</tbody>
</table>
<p><strong>Angular ajax requests vs Sails socket requests</strong></p>
<table>
<thead>
<tr>
<th>Angular ajax</th>
<th>Sails socket</th>
</tr>
</thead>
<tbody>
<tr>
<td>$http.get()</td>
<td>io.socket.get()</td>
</tr>
<tr>
<td>$http.post()</td>
<td>io.socket.post()</td>
</tr>
<tr>
<td>$http.put()</td>
<td>io.socket.put()</td>
</tr>
<tr>
<td>$http.delete()</td>
<td>io.socket.delete()</td>
</tr>
</tbody>
</table>
<h2>
<a id="user-content-chapter-5--custom-backend-code" class="anchor" href="#chapter-5--custom-backend-code" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 5 — Custom backend code</h2>
<ul>
<li>
<p><a href="http://sailsjs.org/#/documentation/reference/sails.config/sails.config.bootstrap.html"><strong>config/bootstrap.js</strong></a>
: an asynchronous function that runs before your Sails app gets lifted. This gives you an opportunity to set up your data model, run jobs, or perform some special logic.</p>
</li>
<li>
<p><a href="http://node-machine.org/machinepacks"><strong>Machinepacks</strong></a>
: a sets of related utilities for performing common, repetitive development tasks with Node.js.</p>
</li>
<li>
<p><a href="http://sailsjs.org/#!/documentation/anatomy/myApp/config/local.js.html"><strong>config/local.js</strong></a>
: a special file that allows you to set custom configuration without checking it in to version control, useful for plugging in sensitive credentials, like API keys.</p>
</li>
</ul>
<h2>
<a id="user-content-chapter-6--using-models" class="anchor" href="#chapter-6--using-models" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 6 — Using models</h2>
<p>Sails looks for database connection in the following order (using User API):</p>
<ol>
<li>
<strong>user model</strong>	: api/models/User.js</li>
<li>
<strong>setttings</strong>	: config/models.js</li>
<li>
<strong>connection</strong>	: config/connections.js</li>
<li>
<strong>adapter</strong>		: .tmp/localDiskDb.db</li>
</ol>
<p><strong>Install postgres adapter:</strong></p>
<div class="highlight highlight-source-shell"><pre>npm install sails-postgresql --save</pre></div>
<p>Sails console : interactive REPL (read, eval, print loop) tools that allows you to interact with models.
Sails uses <a href="http://sailsjs.com/documentation/concepts/models-and-orm/query-language">Waterline ORM</a> to interact with records from any supported database.</p>
<div class="highlight highlight-source-shell"><pre>sails console</pre></div>
<p><strong>Query examples:</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> create new record</span>
<span class="pl-smi">User</span>.<span class="pl-en">create</span>({email<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>sailsinaction@gmail.com<span class="pl-pds">'</span></span>, username<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>sailsinaction<span class="pl-pds">'</span></span>, deleted<span class="pl-k">:</span><span class="pl-c1">false</span>, banned<span class="pl-k">:</span><span class="pl-c1">false</span>, admin<span class="pl-k">:</span><span class="pl-c1">false</span>}).<span class="pl-c1">exec</span>(<span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">foundRecords</span>){
	<span class="pl-k">if</span>(err) <span class="pl-en">console</span>.<span class="pl-c1">log</span>(err);
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>(foundRecords);
});

<span class="pl-c"><span class="pl-c">//</span> list all records</span>
<span class="pl-smi">User</span>.<span class="pl-c1">find</span>().<span class="pl-c1">exec</span>(<span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">foundRecords</span>){
	<span class="pl-k">if</span>(err) <span class="pl-en">console</span>.<span class="pl-c1">log</span>(err);
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>The user records: <span class="pl-pds">'</span></span>, foundRecords);
});

<span class="pl-c"><span class="pl-c">//</span> find records matching parameter arrays</span>
<span class="pl-smi">User</span>.<span class="pl-c1">find</span>({username<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>sailsinaction<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>nikolateslaidol<span class="pl-pds">'</span></span>]}).<span class="pl-c1">exec</span>(<span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">foundRecords</span>){
	<span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">log</span>(err);
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>(foundRecords);
});

<span class="pl-c"><span class="pl-c">//</span> find single record matching param</span>
<span class="pl-smi">User</span>.<span class="pl-en">findOne</span>({email<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>sailsinaction@gmail.com<span class="pl-pds">'</span></span>}).<span class="pl-c1">exec</span>(<span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">found</span>) {
	<span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">log</span>(err);
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>(found);
});

<span class="pl-c"><span class="pl-c">//</span> update record matching param</span>
<span class="pl-smi">User</span>.<span class="pl-en">update</span>({username<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>sailsinaction<span class="pl-pds">'</span></span>}, {admin<span class="pl-k">:</span> <span class="pl-c1">true</span>}).<span class="pl-c1">exec</span>(<span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">updatedRecord</span>){
	<span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">log</span>(err);
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>(updatedRecord);
});

<span class="pl-c"><span class="pl-c">//</span> delete record matching param</span>
<span class="pl-smi">User</span>.<span class="pl-en">destroy</span>({deleted<span class="pl-k">:</span> <span class="pl-c1">true</span>}).<span class="pl-c1">exec</span>(<span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">deletedRecord</span>){
	<span class="pl-k">if</span> (err) <span class="pl-en">console</span>.<span class="pl-c1">log</span>(err);
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>(deletedRecord);
});</pre></div>
<h2>
<a id="user-content-chapter-7--custom-actions" class="anchor" href="#chapter-7--custom-actions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 7 — Custom actions</h2>
<blockquote>
<p><a href="https://lodash.com/">Lodash</a> describes itself as a modern JavaScript utility library. The library is accessible via the global underscore (_) symbol. As its name suggests, it checks to see if a value is undefined.</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre>npm install machinepack-emailaddresses --save
npm install machinepack-passwords --save</pre></div>
<p><strong>Using try/catch block</strong>:</p>
<p>The usage of <strong>.execSync()</strong> has two distinct differences in the synchronous usage of a machine:</p>
<ol>
<li>There’s no callback that passes an error and any result of the machine — you need to provide a variable that will be assigned the value of a successfully returned result.</li>
<li>You're wrapping the machine in a try/catch. This will handle any errors without crashing the application.</li>
</ol>
<p><strong>Responses</strong></p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Response</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>OK</td>
</tr>
<tr>
<td>400</td>
<td>Request Invalid</td>
</tr>
<tr>
<td>409</td>
<td>Conflict</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
</tr>
</tbody>
</table>
<p>Sailsjs built-in response : <a href="http://sailsjs.com/documentation/reference/response-res">http://sailsjs.com/documentation/reference/response-res</a></p>
<ul>
<li>res.negotiate(err) : given an error (err), attempt to guess which error response should be called (badRequest, forbidden, notFound, or serverError) by inspecting the status property. If err is not a dictionary, or the status property does not match a known HTTP status code, then default to serverError.</li>
</ul>
<p>Sailsjs custom responses can be added in <strong>api/responses</strong> folder eg: api/responses/alreadyInUse.js</p>
<p><strong>Exec() vs execSync()</strong></p>
<ul>
<li>exec() : can be used with any node-machine</li>
<li>execSync() : only relevant for machines with guaranteed immediate/synchronous behaviour</li>
</ul>
<p>More detailed explanation on exec() vs execSync() : <a href="https://groups.google.com/forum/#!topic/node-machine/-qhqq2kUyGM">https://groups.google.com/forum/#!topic/node-machine/-qhqq2kUyGM</a></p>
<h2>
<a id="user-content-chapter-8--server-rendered-views" class="anchor" href="#chapter-8--server-rendered-views" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 8 — Server-rendered views</h2>
<p>By default, Sailsjs uses <a href="http://www.embeddedjs.com/">Embedded Javascript/EJS</a> template engine to combine the templates and data to produce HTML.</p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> return profile template with json data</span>
<span class="pl-k">return</span> <span class="pl-smi">res</span>.<span class="pl-en">view</span>(<span class="pl-s"><span class="pl-pds">'</span>profile<span class="pl-pds">'</span></span>, {
	me<span class="pl-k">:</span> {
		id<span class="pl-k">:</span> <span class="pl-smi">user</span>.<span class="pl-c1">id</span>,
		email<span class="pl-k">:</span> <span class="pl-smi">user</span>.<span class="pl-smi">email</span>,
		gravatarURL<span class="pl-k">:</span> <span class="pl-smi">user</span>.<span class="pl-smi">gravatarURL</span>,
		admin<span class="pl-k">:</span> <span class="pl-smi">user</span>.<span class="pl-smi">admin</span>
	}
});</pre></div>
<h2>
<a id="user-content-chapter-9--authentication-and-sessions" class="anchor" href="#chapter-9--authentication-and-sessions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 9 — Authentication and sessions</h2>
<div class="highlight highlight-source-js"><pre><span class="pl-smi">req</span>.<span class="pl-smi">session</span>.<span class="pl-smi">userId</span> <span class="pl-k">=</span> <span class="pl-smi">createdUser</span>.<span class="pl-c1">id</span>;</pre></div>
<h2>
<a id="user-content-chapter-10--policies-and-access-control" class="anchor" href="#chapter-10--policies-and-access-control" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 10 — Policies and access control</h2>
<p><strong>Policy</strong> : provide the ability to inject a reusable set of code before a request executes a controller action. Policies’ main benefits are that they can be written once and applied to any controller action. Policies can be used like middleware, meaning you can do almost anything you can imagine with them.</p>
<blockquote>
<p>Middleware is code that can get in the middle of the request/response cycle. For example, the Sails router is middleware. Policies act like middleware and are executed before controller actions, making them ideal for managing access to endpoints.</p>
</blockquote>
<p>Add custom policies in : <strong>api/policies</strong> folder and enable them in <strong>config/policies.js</strong></p>
<p>Best practices for policies include not basing policies on parameters but instead relying on session properties and the results from database queries.</p>
<p><strong>Logging</strong></p>
<p>Default <a href="http://sailsjs.com/documentation/concepts/logging">log level</a> is info and it can be changed in <strong>config/log.js</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> to print log to console, depending on log level</span>
<span class="pl-smi">sails</span>.<span class="pl-smi">log</span>.<span class="pl-en">info</span>(<span class="pl-smi">req</span>.<span class="pl-smi">session</span>.<span class="pl-smi">userId</span>);</pre></div>
<h2>
<a id="user-content-chapter-11--refactoring" class="anchor" href="#chapter-11--refactoring" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 11 — Refactoring</h2>
<blockquote>
<p>a process in which you take existing code and restructure it. This is done for a variety of reasons including organization, readability, and an overall reduction in the complexity.</p>
</blockquote>
<p><strong>WARNING!</strong> — database connection option should <strong>NOT</strong> be duplicated or declared in 2 different files like the following scenario or else Sails will crash with message: error: A hook (orm) failed to load!.</p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> file : config/models.js</span>
<span class="pl-c1">module</span>.<span class="pl-smi">exports</span>.<span class="pl-smi">models</span> <span class="pl-k">=</span> {
  connection<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>myPostgresqlServer<span class="pl-pds">'</span></span>,
  <span class="pl-k">...</span>
};

<span class="pl-c"><span class="pl-c">//</span> file : config/local.js</span>
<span class="pl-c1">module</span>.<span class="pl-smi">exports</span>.<span class="pl-smi">connections</span> <span class="pl-k">=</span> {
  myPostgresqlServer<span class="pl-k">:</span> {
      adapter<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>sails-postgresql<span class="pl-pds">'</span></span>,  
      <span class="pl-k">...</span>
  }
}</pre></div>
<p><strong>Routing</strong></p>
<p>Setting <strong>skipAssets: true</strong> prevents slug routing from affecting files under assets folder.</p>
<div class="highlight highlight-source-js"><pre><span class="pl-s"><span class="pl-pds">'</span>GET /:username<span class="pl-pds">'</span></span><span class="pl-k">:</span> {
	controller<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>PageController<span class="pl-pds">'</span></span>,
	action<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>profile<span class="pl-pds">'</span></span>,
	skipAssets<span class="pl-k">:</span> <span class="pl-c1">true</span>
}</pre></div>
<p>Immediately invoked function expression (IIFE) : a function that's both declared and executed at the same time.</p>
<p>Method <strong>unique()</strong> of machinepack-strings seemed to be deprecated, use <a href="http://node-machine.org/machinepack-strings/random"><strong>random()</strong></a> for now.</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> randomString <span class="pl-k">=</span> <span class="pl-smi">Strings</span>.<span class="pl-en">unique</span>({}).<span class="pl-en">execSync</span>(); <span class="pl-c"><span class="pl-c">//</span> deprecated</span>
<span class="pl-k">var</span> randomString <span class="pl-k">=</span> <span class="pl-smi">Strings</span>.<span class="pl-en">random</span>({}).<span class="pl-en">execSync</span>(); <span class="pl-c"><span class="pl-c">//</span> use this for now</span></pre></div>
<h2>
<a id="user-content-chapter-12--embedded-data-and-associations" class="anchor" href="#chapter-12--embedded-data-and-associations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Chapter 12 — Embedded data and associations</h2>
<p><strong>Relationship characteristics:</strong></p>
<ol>
<li>
<strong>Direction (one-way or two-way reference)</strong> : a relationship has a two-way reference if both models require the ability to find, create, update, or destroy records in each model.</li>
<li>
<strong>Quantity (one or many)</strong> : does the related model have a relationship with one record or multiple records? Between the user and tutorial models, the user can own multiple tutorials, but a tutorial can be owned by only one user.</li>
</ol>
<p><strong>Three ways to create relationships in models:</strong></p>
<ol>
<li>
<strong>Embedding values</strong> : embed values from one model’s record into another model’s record and then maintain each embedded value for each record.</li>
<li>
<strong>One-way association reference</strong> :  use Waterline associations to create a one-way reference association between two models and then maintain each reference.</li>
<li>
<strong>Two-way association reference</strong> : use Waterline associations to create a two-way referenced association between two models and maintain a single reference for both associations.</li>
</ol>
<p><strong>Configuring an association between two models:</strong></p>
<ul>
<li>The model to associate to.</li>
<li>Whether to associate one record, also called a model association, or many records, also called a collection association.</li>
<li>In the case of a collection, whether it’s a one-way or a two-way association.</li>
</ul>
<p><strong>Service</strong> : one or more functions declared within a dictionary that Sails globalizes, making the functions available everywhere. Located at <strong>api/services</strong> folder.</p>
</article></body></html>